

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pronunciador Pro - Vista Completa</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4.1.7"></script>
    <script src="https://unpkg.com/@babel/standalone@7.26.10/babel.min.js"></script>
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.3.1",
            "react/": "https://esm.sh/react@18.3.1/",
            "react-dom/client": "https://esm.sh/react-dom@18.3.1/client",
            "lucide-react": "https://esm.sh/lucide-react@0.474.0?external=react"
        }
    }
    </script>
    <style>
        input, select { font-size: 16px !important; }
        button { -webkit-tap-highlight-color: transparent; user-select: none; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel" data-type="module" data-presets="react">
        import React, { useState, useRef, useEffect, useMemo } from 'react';
        import { createRoot } from 'react-dom/client';
        import { Volume2, Play, Pause, Globe, Sliders, User, UserCheck, RefreshCw, ExternalLink } from 'lucide-react';

        function App() {
            const [word, setWord] = useState('');
            const [language, setLanguage] = useState('en');
            const [gender, setGender] = useState('female');
            const [isPlaying, setIsPlaying] = useState(false);
            const [speed, setSpeed] = useState(1);
            const [pitch, setPitch] = useState(1);
            const [availableVoices, setAvailableVoices] = useState([]);
            const [selectedVoiceURI, setSelectedVoiceURI] = useState('');

            const languages = [
                { code: 'en', name: 'English', flag: 'ðŸ‡¬ðŸ‡§', langCode: 'en' },
                { code: 'no', name: 'Norsk', flag: 'ðŸ‡³ðŸ‡´', langCode: 'no' },
                { code: 'nl', name: 'Nederlands', flag: 'ðŸ‡³ðŸ‡±', langCode: 'nl' },
                { code: 'es', name: 'EspaÃ±ol', flag: 'ðŸ‡ªðŸ‡¸', langCode: 'es' },
                { code: 'fr', name: 'FranÃ§ais', flag: 'ðŸ‡«ðŸ‡·', langCode: 'fr' },
                { code: 'de', name: 'Deutsch', flag: 'ðŸ‡©ðŸ‡ª', langCode: 'de' },
                { code: 'it', name: 'Italiano', flag: 'ðŸ‡®ðŸ‡¹', langCode: 'it' },
                { code: 'pt', name: 'PortuguÃªs', flag: 'ðŸ‡µðŸ‡¹', langCode: 'pt' },
                { code: 'ko', name: 'í•œêµ­ì–´', flag: 'ðŸ‡°ðŸ‡·', langCode: 'ko' }
            ];

            const loadVoices = () => {
                const voices = window.speechSynthesis.getVoices();
                if (voices.length > 0) {
                    setAvailableVoices(voices);
                }
            };

            useEffect(() => {
                loadVoices();
                if (window.speechSynthesis.onvoiceschanged !== undefined) {
                    window.speechSynthesis.onvoiceschanged = loadVoices;
                }
                const timer = setTimeout(loadVoices, 1000);
                return () => clearTimeout(timer);
            }, []);

            const currentLangVoices = useMemo(() => {
                const lang = languages.find(l => l.code === language);
                return availableVoices.filter(v => v.lang.toLowerCase().startsWith(lang.langCode));
            }, [availableVoices, language]);

            const isMaleVoice = (name) => {
                const n = name.toLowerCase();
                return n.includes('male') || n.includes('man') || n.includes('david') || 
                       n.includes('pablo') || n.includes('daniel') || n.includes('stefan') || 
                       n.includes('lars') || n.includes('magnus') || n.includes('wouter') ||
                       n.includes('nathan') || n.includes('arthur') || n.includes('siri male');
            };

            useEffect(() => {
                if (currentLangVoices.length > 0) {
                    const voicesByGender = currentLangVoices.filter(v => 
                        gender === 'male' ? isMaleVoice(v.name) : !isMaleVoice(v.name)
                    );
                    setSelectedVoiceURI(voicesByGender.length > 0 ? voicesByGender[0].voiceURI : currentLangVoices[0].voiceURI);
                }
            }, [currentLangVoices, gender]);

            const speak = () => {
                if (!word.trim()) return;
                if (window.speechSynthesis.speaking) {
                    window.speechSynthesis.cancel();
                    setIsPlaying(false);
                    return;
                }

                const utterance = new SpeechSynthesisUtterance(word);
                const voice = availableVoices.find(v => v.voiceURI === selectedVoiceURI);
                
                if (voice) {
                    utterance.voice = voice;
                    utterance.lang = voice.lang;
                } else {
                    const langObj = languages.find(l => l.code === language);
                    utterance.lang = langObj.langCode;
                }

                utterance.rate = speed;
                utterance.pitch = pitch;

                utterance.onstart = () => setIsPlaying(true);
                utterance.onend = () => setIsPlaying(false);
                utterance.onerror = () => setIsPlaying(false);

                window.speechSynthesis.speak(utterance);
            };

            const getExternalSources = (w) => {
                const encoded = encodeURIComponent(w);
                return [
                    { name: 'Forvo', icon: 'ðŸŽ¤', url: `https://forvo.com/search/${encoded}/${language}/` },
                    { name: 'Google', icon: 'ðŸ”¤', url: `https://translate.google.com/?sl=${language}&text=${encoded}` },
                ];
            };

            return (
                <div className="min-h-screen bg-indigo-50 p-4 md:p-8 font-sans">
                    <div className="max-w-2xl mx-auto space-y-6">
                        
                        <header className="text-center py-2">
                            <div className="bg-indigo-600 w-14 h-14 rounded-2xl flex items-center justify-center mx-auto mb-2 shadow-lg">
                                <Volume2 className="text-white w-8 h-8" />
                            </div>
                            <h1 className="text-xl font-black text-indigo-900 uppercase tracking-tight">Pronunciador Pro</h1>
                        </header>

                        <div className="bg-white rounded-3xl shadow-xl p-5 space-y-5 border border-indigo-100">
                            
                            {/* Idiomas en cuadrÃ­cula (grid) */}
                            <div className="grid grid-cols-3 gap-2">
                                {languages.map(l => (
                                    <button 
                                        key={l.code}
                                        onClick={() => setLanguage(l.code)}
                                        className={`px-2 py-2.5 rounded-xl text-xs font-bold transition-all border ${language === l.code ? 'bg-indigo-600 text-white border-indigo-600 shadow-md scale-[1.02]' : 'bg-white border-slate-100 text-slate-500 hover:border-indigo-200'}`}
                                    >
                                        <div className="text-base mb-0.5">{l.flag}</div>
                                        <div className="truncate">{l.name}</div>
                                    </button>
                                ))}
                            </div>

                            {/* Input */}
                            <input 
                                type="text"
                                value={word}
                                onChange={(e) => setWord(e.target.value)}
                                onKeyPress={(e) => e.key === 'Enter' && speak()}
                                placeholder="Escribe aquÃ­..."
                                className="w-full p-4 bg-slate-50 rounded-2xl text-xl font-bold text-indigo-900 border-2 border-transparent focus:border-indigo-500 outline-none transition-all shadow-inner"
                            />

                            {/* Selector de GÃ©nero y Voces */}
                            <div className="space-y-3">
                                <div className="grid grid-cols-2 gap-3">
                                    <button 
                                        onClick={() => setGender('female')}
                                        className={`py-3 rounded-2xl flex items-center justify-center gap-2 font-bold transition-all ${gender === 'female' ? 'bg-pink-500 text-white shadow-md' : 'bg-slate-100 text-slate-400'}`}
                                    >
                                        <User className="w-4 h-4" /> Mujer
                                    </button>
                                    <button 
                                        onClick={() => setGender('male')}
                                        className={`py-3 rounded-2xl flex items-center justify-center gap-2 font-bold transition-all ${gender === 'male' ? 'bg-blue-500 text-white shadow-md' : 'bg-slate-100 text-slate-400'}`}
                                    >
                                        <UserCheck className="w-4 h-4" /> Hombre
                                    </button>
                                </div>

                                <div className="relative">
                                    <select 
                                        value={selectedVoiceURI}
                                        onChange={(e) => setSelectedVoiceURI(e.target.value)}
                                        className="w-full p-3.5 bg-slate-50 rounded-2xl text-sm font-medium border border-slate-200 appearance-none outline-none focus:border-indigo-300"
                                    >
                                        {currentLangVoices.map(v => (
                                            <option key={v.voiceURI} value={v.voiceURI}>{v.name}</option>
                                        ))}
                                        {currentLangVoices.length === 0 && <option>Cargando voces...</option>}
                                    </select>
                                    <button onClick={loadVoices} className="absolute right-3 top-1/2 -translate-y-1/2 p-2 text-indigo-400">
                                        <RefreshCw className="w-4 h-4" />
                                    </button>
                                </div>
                            </div>

                            {/* Sliders de Ajuste */}
                            <div className="bg-slate-50 p-4 rounded-2xl space-y-4">
                                <div className="space-y-2">
                                    <div className="flex justify-between text-[10px] font-black text-indigo-400 uppercase tracking-widest">
                                        <span>Velocidad</span>
                                        <span className="bg-indigo-100 text-indigo-600 px-1.5 rounded">{speed.toFixed(1)}x</span>
                                    </div>
                                    <input 
                                        type="range" min="0.5" max="2" step="0.1" value={speed} 
                                        onChange={(e) => setSpeed(parseFloat(e.target.value))}
                                        className="w-full h-1.5 bg-indigo-200 rounded-lg appearance-none accent-indigo-600"
                                    />
                                </div>
                                <div className="space-y-2">
                                    <div className="flex justify-between text-[10px] font-black text-indigo-400 uppercase tracking-widest">
                                        <span>Tono</span>
                                        <span className="bg-indigo-100 text-indigo-600 px-1.5 rounded">{pitch.toFixed(1)}x</span>
                                    </div>
                                    <input 
                                        type="range" min="0.5" max="2" step="0.1" value={pitch} 
                                        onChange={(e) => setPitch(parseFloat(e.target.value))}
                                        className="w-full h-1.5 bg-indigo-200 rounded-lg appearance-none accent-indigo-600"
                                    />
                                </div>
                            </div>

                            {/* BotÃ³n Reproducir */}
                            <button 
                                onClick={speak}
                                disabled={!word.trim()}
                                className={`w-full py-5 rounded-3xl font-black text-lg flex items-center justify-center gap-3 transition-all active:scale-95 shadow-lg ${isPlaying ? 'bg-red-500 text-white' : 'bg-indigo-600 text-white disabled:opacity-30'}`}
                            >
                                {isPlaying ? <Pause className="w-6 h-6 fill-current" /> : <Play className="w-6 h-6 fill-current" />}
                                {isPlaying ? 'DETENER' : 'REPRODUCIR'}
                            </button>

                            {/* Enlaces Externos */}
                            {word.trim() && (
                                <div className="flex justify-center gap-3 pt-1">
                                    {getExternalSources(word).map(s => (
                                        <a 
                                            key={s.name} 
                                            href={s.url} 
                                            target="_blank" 
                                            className="flex items-center gap-1 px-3 py-1 bg-indigo-50 rounded-full text-indigo-600 text-[10px] font-bold hover:bg-indigo-100 transition-colors"
                                        >
                                            {s.icon} {s.name} <ExternalLink className="w-2.5 h-2.5" />
                                        </a>
                                    ))}
                                </div>
                            )}

                        </div>
                    </div>
                </div>
            );
        }

        createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>


